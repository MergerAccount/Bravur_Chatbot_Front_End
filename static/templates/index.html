<!-- Floating Widget Template: static/templates/widget.html -->
<div class="bravur-chatbot-widget" data-session-id="">
    <!-- Floating Toggle Button -->
    <div id="chatbot-toggle-btn" class="chatbot-toggle-btn">
        <span id="toggle-icon">üí¨</span>
    </div>

    <!-- Popup Container (hidden by default) -->
    <div id="chatbot-container" class="chatbot-popup chatbot-hidden">
        <div class="chat-container">
            <div class="chat-header">
                <h1>Bravur AI Chatbot</h1>
            </div>

            <div class="language-toggle-container">
                <div class="language-toggle">
                    <button id="eng-btn" class="language-btn active" data-lang="en-US">ENG</button>
                    <button id="nl-btn" class="language-btn inactive" data-lang="nl-NL">NL</button>
                </div>
            </div>

            <div id="chat-box" class="chat-box"></div>
            <div class="spinner" id="spinner" style="display: none;">
                <div class="typing-indicator">AI is typing...</div>
            </div>

            <!-- Consent Chat Bubble -->
            <div id="consent-bubble" class="consent-bubble" style="display: none;">
                <div class="consent-message">
                    <p>We use cookies and collect data to improve your experience. Please accept to continue using the
                        chatbot.</p>
                    <button id="accept-consent-btn" class="accept-consent-btn">Accept</button>
                </div>
            </div>

            <div class="input-container">
                <button id="sts-btn" title="Use Voice Mode ü§ñ">ü§ñ</button>
                <button id="voice-chat-btn" title="Dictate üé§">üé§</button>
                <input type="text" id="user-input" placeholder="Type your question...">
                <button id="send-btn">Send</button>
            </div>

            <!-- Add this to both widget.html and embedded.html -->
            <!-- <button onclick="testCaptcha()"
                style="position: fixed; top: 10px; right: 10px; z-index: 10000; padding: 10px; background: #ff0000; color: white;">
                TEST CAPTCHA
            </button>

            <script>
                function testCaptcha() {
                    if (typeof checkAndMaybeTriggerCaptcha === 'function') {
                        // Simulate 4/5 requests (80% of threshold)
                        checkAndMaybeTriggerCaptcha(4, 5);
                    } else {
                        alert("CAPTCHA function not loaded!");
                    }
                }
            </script> -->

            <div class="session-info">Session ID: <span id="session-id">Loading...</span></div>

            <div class="show-feedback-btn" id="show-feedback-btn" style="display: block;">
                <button onclick="showFeedback()">Give Feedback</button>
            </div>

            <div class="feedback-container" id="feedback-container" style="display: none;">
                <h3>Rate your experience</h3>
                <div class="smiley-row" id="smiley-row">
                    <span onclick="selectSmiley(1)">üò†</span>
                    <span onclick="selectSmiley(2)">üòï</span>
                    <span onclick="selectSmiley(3)">üòê</span>
                    <span onclick="selectSmiley(4)">üôÇ</span>
                    <span onclick="selectSmiley(5)">üòç</span>
                </div>
                <textarea id="feedback-comment" rows="3" placeholder="Optional comment..."></textarea>
                <div class="feedback-actions">
                    <button onclick="submitFeedback()">Submit Feedback</button>
                    <button onclick="hideFeedback()" style="background:#ccc;color:#000;">Hide</button>
                </div>
                <div id="edit-feedback-btn" style="margin-top: 10px; display: none;">
                    <button class="edit-feedback" onclick="enableEditMode()">Edit Feedback</button>
                </div>
                <div id="feedback-message" class="feedback-message"></div>
            </div>

            <div class="chat-footer">
                <div class="footer-left">
                    <a href="#" onclick="showPolicy(event)">Privacy Policy</a>
                    <a href="#" onclick="showTerms(event)">Terms of Use</a>
                    <a href="#" onclick="showManageData(event)">Manage My Data</a>
                </div>
            </div>

            <div class="dropdown-content-container" id="dropdown-content-container" style="display: none;">
                <div class="dropdown-content" id="dropdown-content"></div>
                <div class="footer-actions">
                    <button onclick="hideDropdown()">Hide</button>
                </div>
            </div>
        </div>
    </div>
</div>